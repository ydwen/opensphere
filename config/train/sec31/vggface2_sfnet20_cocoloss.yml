project:
  val_intvl: 2000
  save_iters: [76000, 77000, 78000, 79000, 80000]
  train_log:
    info_intvl: 200
    fmt: '6.3f'
  val_log:
    info_intvl: 1
    fmt: '6.3f'
data:
  base:
    dataset:
      type: PairDataset
      data_dir: data/val/
      test_mode: true
    dataloader: {
      type: DataLoader, batch_size: 512,
      shuffle: false, drop_last: false,
      num_workers: 4, pin_memory: true,
    }
  train:
    dataset:
      type: ClassDataset
      name: VGGFace2
      data_dir: data/train/
      ann_path: data/train/vggface2_train_ann.txt
      test_mode: false
    dataloader: {batch_size: 512, shuffle: true, drop_last: true}
  val:
  - dataset:
      name: VGGFace2_50
      data_dir: data/train/
      ann_path: data/train/vggface2_train50_ann.txt
      metrics: [EER]
  - dataset:
      name: LFW
      ann_path: data/val/lfw_ann.txt
      metrics: [ACC]
  - dataset:
      name: AgeDB-30
      ann_path: data/val/agedb_30_ann.txt
      metrics: [ACC]
  - dataset:
      name: CA-LFW
      ann_path: data/val/calfw_ann.txt
      metrics: [ACC]
  - dataset:
      name: CP-LFW
      ann_path: data/val/cplfw_ann.txt
      metrics: [ACC]
model:
  backbone:
    type: sfnet20_deprecated
    in_channel: 3
    channels: [64, 128, 256, 512]
    out_channel: 512
  head:
    type: CocoLoss
    s: 30
  optimizer:
    type: SGD
    lr: 0.1
    momentum: 0.9
    weight_decay: 0.0005
  scheduler:
    type: MultiStepLR
    gamma: 0.1
    milestones: [40000, 60000, 80000]
  max_grad_norm: 10.0
